function [ p1 ] = myfunc2(si, S, T)
p = 5;
m1 = 6000;
% m2= 3000;
m3= 9000;
% m4= 3000;
% m5= 3000;
m6= 5000;
si1=si(1,1);
si2=si(1,2);
si3=si(1,3);
si4=si(1,4);
si5=si(1,5);
% si6=si(1,5);
% si7=si(1,5);
% si8=si(1,5);
% si9=si(1,5);
S1= S(1:6000, 1:10);
% S2= S(3001:6000, 1:10);
S3= S(6001:15000, 1:10);
% S4= S(9001:12000, 1:10);
% S5= S(12001:15000, 1:10);
ST= S(15001:20000, 1:10);
% XS= S(317:427, 1:5);


% si1=0.002;
% si2=0.001;
% si3=0.001;
% si4=0.002;
% if si1>0;si2>0;si3>0;si4>0


K11 = zeros(1,1);
for i=1:5000
    K11(i)=sum(exp(-((S1(1:6000,1)-ST(i,1)).^2)/(2*si1.^2)));
end
% Ka1=K11-1;

K12 = zeros(1,1);
for i=1:5000
    K12(i)=sum(exp(-((S1(1:6000,2)-ST(i,2)).^2)/(2*si2.^2)));
end
% Ka2=K12-1;

K13 = zeros(1,1);
for i=1:5000
    K13(i)=sum(exp(-((S1(1:6000,3)-ST(i,3)).^2)/(2*si3.^2)));
end
% Ka3=K13-1;

K14 = zeros(1,1);
for i=1:5000
    K14(i)=sum(exp(-((S1(1:6000,4)-ST(i,4)).^2)/(2*si4.^2)));
end
% Ka4=K14-1;

K15 = zeros(1,1);
for i=1:5000
    K15(i)=sum(exp(-((S1(1:6000,5)-ST(i,5)).^2)/(2*si5.^2)));
end
% Ka5=K15-1;

K16 = zeros(1,1);
for i=1:5000
    K16(i)=sum(exp(-((S1(1:6000,6)-ST(i,6)).^2)/(2*si5.^2)));
end
% Ka6=K16-1;

K17 = zeros(1,1);
for i=1:5000
    K17(i)=sum(exp(-((S1(1:6000,7)-ST(i,7)).^2)/(2*si5.^2)));
end
% Ka7=K17-1;

K18 = zeros(1,1);
for i=1:5000
    K18(i)=sum(exp(-((S1(1:6000,8)-ST(i,8)).^2)/(2*si5.^2)));
end
% Ka8=K18-1;

K19 = zeros(1,1);
for i=1:5000
    K19(i)=sum(exp(-((S1(1:6000,9)-ST(i,9)).^2)/(2*si5.^2)));
end
% Ka9=K19-1;


Fl1 =((K11.*K12.*K13.*K14.*K15.*K16.*K17.*K18.*K19)/(((2*3.14).^(p/2))*(si1*si2*si3*si4*si5)*m1));


% K21 = zeros(1,1);
% for i=1:5000
%     K21(i)=sum(exp(-((S2(1:3000,1)-ST(i,1)).^2)/(2*si1.^2)));
% end
% % Kb1=K21-1;
% 
% K22 = zeros(1,1);
% for i=1:5000
%     K22(i)=sum(exp(-((S2(1:3000,2)-ST(i,2)).^2)/(2*si2.^2)));
% end
% % Kb2=K22-1;
% 
% K23 = zeros(1,1);
% for i=1:5000
%     K23(i)=sum(exp(-((S2(1:3000,3)-ST(i,3)).^2)/(2*si3.^2)));
% end
% % Kb3=K23-1;
% 
% K24 = zeros(1,1);
% for i=1:5000
%     K24(i)=sum(exp(-((S2(1:3000,4)-ST(i,4)).^2)/(2*si4.^2)));
% end
% % Kb4=K24-1;
% 
% K25 = zeros(1,1);
% for i=1:5000
%     K25(i)=sum(exp(-((S2(1:3000,5)-ST(i,5)).^2)/(2*si5.^2)));
% end
% % Kb5=K25-1;
% 
% K26 = zeros(1,1);
% for i=1:5000
%     K26(i)=sum(exp(-((S2(1:3000,6)-ST(i,6)).^2)/(2*si5.^2)));
% end
% % Kb6=K26-1;
% 
% K27 = zeros(1,1);
% for i=1:5000
%     K27(i)=sum(exp(-((S2(1:3000,7)-ST(i,7)).^2)/(2*si5.^2)));
% end
% % Kb7=K27-1;
% 
% K28 = zeros(1,1);
% for i=1:5000
%     K28(i)=sum(exp(-((S2(1:3000,8)-ST(i,8)).^2)/(2*si5.^2)));
% end
% % Kb8=K28-1;
% 
% K29 = zeros(1,1);
% for i=1:5000
%     K29(i)=sum(exp(-((S2(1:3000,9)-ST(i,9)).^2)/(2*si5.^2)));
% end
% % Kb9=K29-1;
% 
% 
% Fl2 =((K21.*K22.*K23.*K24.*K25.*K26.*K27.*K28.*K29)/(((2*3.14).^(p/2))*(si1*si2*si3*si4*si5)*m2));


K31 = zeros(1,1);
for i=1:5000
    K31(i)=sum(exp(-((S3(1:9000,1)-ST(i,1)).^2)/(2*si1.^2)));
end
% Kc1=K31-1;

K32 = zeros(1,1);
for i=1:5000
    K32(i)=sum(exp(-((S3(1:9000,2)-ST(i,2)).^2)/(2*si2.^2)));
end
% Kc2=K32-1;

K33 = zeros(1,1);
for i=1:5000
    K33(i)=sum(exp(-((S3(1:9000,3)-ST(i,3)).^2)/(2*si3.^2)));
end
% Kc3=K33-1;

K34 = zeros(1,1);
for i=1:5000
    K34(i)=sum(exp(-((S3(1:9000,4)-ST(i,4)).^2)/(2*si4.^2)));
end
% Kc4=K34-1;

K35 = zeros(1,1);
for i=1:5000
    K35(i)=sum(exp(-((S3(1:9000,5)-ST(i,5)).^2)/(2*si5.^2)));
end
% Kc5=K35-1;

K36 = zeros(1,1);
for i=1:5000
    K36(i)=sum(exp(-((S3(1:9000,6)-ST(i,6)).^2)/(2*si5.^2)));
end
% Kc6=K36-1;

K37 = zeros(1,1);
for i=1:5000
    K37(i)=sum(exp(-((S3(1:9000,7)-ST(i,7)).^2)/(2*si5.^2)));
end
% Kc7=K37-1;

K38 = zeros(1,1);
for i=1:5000
    K38(i)=sum(exp(-((S3(1:9000,8)-ST(i,8)).^2)/(2*si5.^2)));
end
% Kc8=K38-1;

K39 = zeros(1,1);
for i=1:5000
    K39(i)=sum(exp(-((S3(1:9000,9)-ST(i,9)).^2)/(2*si5.^2)));
end
% Kc9=K39-1;



Fl3 =((K31.*K32.*K33.*K34.*K35.*K36.*K37.*K38.*K39)/(((2*3.14).^(p/2))*(si1*si2*si3*si4*si5)*m3));



% K41 = zeros(1,1);
% for i=1:5000
%     K41(i)=sum(exp(-((S4(1:3000,1)-ST(i,1)).^2)/(2*si1.^2)));
% end
% % Kd1=K41-1;
% 
% K42 = zeros(1,1);
% for i=1:5000
%     K42(i)=sum(exp(-((S4(1:3000,2)-ST(i,2)).^2)/(2*si2.^2)));
% end
% % Kd2=K42-1;
% 
% K43 = zeros(1,1);
% for i=1:5000
%     K43(i)=sum(exp(-((S4(1:3000,3)-ST(i,3)).^2)/(2*si3.^2)));
% end
% % Kd3=K43-1;
% 
% K44 = zeros(1,1);
% for i=1:5000
%     K44(i)=sum(exp(-((S4(1:3000,4)-ST(i,4)).^2)/(2*si4.^2)));
% end
% % Kd4=K44-1;
% 
% K45 = zeros(1,1);
% for i=1:5000
%     K45(i)=sum(exp(-((S4(1:3000,5)-ST(i,5)).^2)/(2*si5.^2)));
% end
% % Kd5=K45-1;
% 
% K46 = zeros(1,1);
% for i=1:5000
%     K46(i)=sum(exp(-((S4(1:3000,6)-ST(i,6)).^2)/(2*si5.^2)));
% end
% % Kd6=K46-1;
% 
% K47 = zeros(1,1);
% for i=1:5000
%     K47(i)=sum(exp(-((S4(1:3000,7)-ST(i,7)).^2)/(2*si5.^2)));
% end
% % Kd7=K47-1;
% 
% K48 = zeros(1,1);
% for i=1:5000
%     K48(i)=sum(exp(-((S4(1:3000,8)-ST(i,8)).^2)/(2*si5.^2)));
% end
% % Kd8=K48-1;
% 
% K49 = zeros(1,1);
% for i=1:5000
%     K49(i)=sum(exp(-((S4(1:3000,9)-ST(i,9)).^2)/(2*si5.^2)));
% end
% % Kd9=K49-1;
% 
% 
% 
% Fl4 =((K41.*K42.*K43.*K44.*K45.*K46.*K47.*K48.*K49)/(((2*3.14).^(p/2))*(si1*si2*si3*si4*si5)*m4));
% 
% 
% K51 = zeros(1,1);
% for i=1:5000
%     K51(i)=sum(exp(-((S5(1:3000,1)-ST(i,1)).^2)/(2*si1.^2)));
% end
% % Ke1=K51-1;
% 
% K52 = zeros(1,1);
% for i=1:5000
%     K52(i)=sum(exp(-((S5(1:3000,2)-ST(i,2)).^2)/(2*si2.^2)));
% end
% % Ke2=K52-1;
% 
% K53 = zeros(1,1);
% for i=1:5000
%     K53(i)=sum(exp(-((S5(1:3000,3)-ST(i,3)).^2)/(2*si3.^2)));
% end
% % Ke3=K53-1;
% 
% K54 = zeros(1,1);
% for i=1:5000
%     K54(i)=sum(exp(-((S5(1:3000,4)-ST(i,4)).^2)/(2*si4.^2)));
% end
% % Ke4=K54-1;
% 
% K55 = zeros(1,1);
% for i=1:5000
%     K55(i)=sum(exp(-((S5(1:3000,5)-ST(i,5)).^2)/(2*si5.^2)));
% end
% % Ke5=K55-1;
% 
% K56 = zeros(1,1);
% for i=1:5000
%     K56(i)=sum(exp(-((S5(1:3000,6)-ST(i,6)).^2)/(2*si5.^2)));
% end
% % Ke6=K56-1;
% 
% K57 = zeros(1,1);
% for i=1:5000
%     K57(i)=sum(exp(-((S5(1:3000,7)-ST(i,7)).^2)/(2*si5.^2)));
% end
% % Ke7=K57-1;
% 
% K58 = zeros(1,1);
% for i=1:5000
%     K58(i)=sum(exp(-((S5(1:3000,8)-ST(i,8)).^2)/(2*si5.^2)));
% end
% % Ke8=K58-1;
% 
% K59 = zeros(1,1);
% for i=1:5000
%     K59(i)=sum(exp(-((S5(1:3000,9)-ST(i,9)).^2)/(2*si5.^2)));
% end
% % Ke9=K59-1;
% 
% 
% 
% Fl5 =((K51.*K52.*K53.*K54.*K55.*K56.*K57.*K58.*K59)/(((2*3.14).^(p/2))*(si1*si2*si3*si4*si5)*m5));

F1=[Fl1;Fl3];
[M1,I1]=max(F1);
D1=I1-T';
C1=sum(D1(:)==0);
P1=C1/m6;
p1=1-P1;



% P=0.5*P1+0.5*p2;

end

